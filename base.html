<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>Visualization Munich</title>
  <script src="https://d3js.org/d3.v4.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
</head>

<body>
  <div id="map"></div>
  <form>
    <fieldset>
      <legend>Static Legend (per district)</legend>
      Intensity of Color: Percentage of foreigners<br>
      Number of Stickmen: Average children per household<br>
      Placeholder:        Average rent in sqm
    </fieldset>
  </form>
  <script type="text/javascript">
    $(document).ready(function(){
      var projection = d3.geoMercator()
        .scale(110000)
        .center([11.61, 48.160]);

      var path = d3.geoPath().projection(projection);

      var svg = d3.select('#map').append('svg')
        .attr("width", 800)
        .attr("height", 600)
        .append("g");

      d3.json("munich.geojson", function(error, mapData) {
        console.log(mapData);
        var features = mapData.features;

        svg.selectAll("path")
          .data(features).enter()
          .append("path")
          .attr("class", "district")
          .attr("data-name", function(munich_district) {
            return munich_district.properties.name;
          })
          .attr("data-munich_r_1", function(munich_district) {
            return munich_district.properties.munich_r_1;
          })
          .attr("data-munich_r_2", function(munich_district) {
            return munich_district.properties.munich_r_2;
          })
          .attr("id", function(munich_district) {
            return munich_district.properties.cartodb_id;
          })
          .attr("title", function(munich_district) {
            return munich_district.properties.name;
          })
          .attr("d", path)
          .style('fill', 'orange')
          .style('stroke', 'black')
          .style('stroke-width', 1)
          .on('mouseover', mouseover)
          .on('mouseout', mouseout);
      });

      function mouseover(d){
      // Highlight hovered province
        d3.select(this).style('fill', 'black');
      }

      function mouseout(d){
      // Highlight hovered province
        d3.select(this).style('fill', 'orange');
      }

      console.log('debug');
      var svgarr = $('path');
      console.log('svgarr' + svgarr);
      $.each(svgarr, function(data) {
        var tmpData = data;
        var id = data.attr('id');
        console.log(id);
        data.append('text', id);
      });
    });

  </script>
</body>

</html>
