<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>Visualization Munich</title>
  <script src="https://d3js.org/d3.v4.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
  <link rel="stylesheet" type="text/css" href="style.css">
</head>

<body> 
  <div id="test"> </div>
  <div id="wrapper"> 
  <div id="map"> </div>
  <div id="sliderDiv">
      <form>
          <fieldset>
            <legend>Static Legend (per district)</legend>
            Intensity of Color: Percentage of foreigners<br>
            Number of Stickmen: Average children per household<br>
            Placeholder:        Average rent in sqm
          </fieldset>
        </form>
    <label>
      <input type="range" min="1" max="3" value="1" class="slider" id="sliderEle">
    </label>
    <label>
      <input type="checkbox" name="zutat" value="salami">
    Kinder Schwarz
    </label>
    <label>
      <input type="checkbox" name="zutat" value="salami">
         Kinder Gelb
    </label>
  </div>
  <div id="sideRight">
    <b> Here is some flavortext</b>
  </div>
</div>
  
  <script type="text/javascript">
    $(document).ready(function(){

      var width = 800
      var height = 600

      var projection = d3.geoMercator()
        .scale(110000)
        .center([11.61, 48.160]);

      var path = d3.geoPath().projection(projection);

      var svg = d3.select('#map').append('svg')
        .attr("width", width)
        .attr("height", height)
        .append("g");

      d3.json("munich.geojson", function(error, mapData) {
        console.log(mapData);
        var features = mapData.features;

        svg.selectAll("path")
          .data(features).enter()
          .append("path")
          .attr("class", "district")
          .attr("data-name", function(munich_district) {
            return munich_district.properties.name;
          })
          .attr("data-munich_r_1", function(munich_district) {
            return munich_district.properties.munich_r_1;
          })
          .attr("data-munich_r_2", function(munich_district) {
            return munich_district.properties.munich_r_2;
          })
          .attr("id", function(munich_district) {
            return munich_district.properties.cartodb_id;
          })
          .attr("title", function(munich_district) {
            return munich_district.properties.name;
          })
          .attr("d", path)
          .style('fill', 'orange')
          .style('stroke', 'black')
          .style('stroke-width', 1)
          .on('mouseover', mouseover)
          .on('mouseout', mouseout)
          .on('click', click, svgClicked);
      });

      function mouseover(d){
      // Highlight hovered province
        d3.select(this).style('fill', 'black');
        $('#4').css('fill', 'black');
        $('#5').append("<div class='overtext'> test </div>");

        //console.log(this.id);
      }

      function mouseout(d){
      // Highlight hovered province
        d3.select(this).style('fill', 'orange');
      }

      function click(d){
        //console.info(this.dataset.name)
      // Highlight hovered province
        console.log(this);
        $('#sideRight').empty();
        $('#sideRight').html(this.id + " " + this.getAttribute('title'));

        var mouse = d3.mouse(this);
        console.log(mouse);
        $('#test').html("<div id='test'>" + this.getAttribute('title') + "</div>");
        //var text = 

        //$('body').append(text);
        $('#test').css({'top':mouse[1],'left':mouse[0]}).fadeIn('slow');
      }

      function svgClicked(d){
        console.log('am here');
        var mouseX = e.pageX; 
        var mouseY = e.pageY;
        
      }
    });

//for Time
 $( "#sliderEle" ).on( "change", function( event, ui ) {
   Console.log('u slided');
 } );

 function nameFn(d){
  return d && d.properties ? d.properties.NOMBRE_DPT : null;
}

</script>

<div id="slidecontainer">
  
</div>
</body>

</html>
